---
title: 跨域
date: 2018-10-05
categories:
 - 跨域
tags:
 - 跨域
---

## 什么是同源策略及其限制内容？

同源策略是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到XSS、CSRF等攻击。所谓同源是指"协议+域名+端口"三者相同，即便两个不同的域名指向同一个ip地址，也非同源。只有这三者完全相同才是同源

## 什么是跨域?

当协议、子域名、主域名、端口号中任意一个不相同时，都算作不同域。不同域之间相互请求资源，就算作“跨域”常见的跨域场景如下
![](https://user-gold-cdn.xitu.io/2018/5/23/1638b3579dde630e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

- 跨域并不是请求发不出去，请求能发出去，服务端能收到请求并正常返回结果，只是结果被浏览器拦截了

## 跨域解决方案

### jsonp
1. jsonp 原理
 - 动态创建一个script标签，利用script标签的src属性没有同源策略的限制，想请求地址发送一个get请求，预先定义这个函数，这个函数的作用是用来接收返回的数据，并且要把这个函数名通过url携带参数的方式发送给服务器，服务器拿到函数名以后，这个函数名包裹服务器返回的数据，也就是服务器返回的是函数的调用

2. JSONP和AJAX对比
JSONP和AJAX相同，都是客户端向服务器端发送请求，从服务器端获取数据的方式。但AJAX属于同源策略，JSONP属于非同源策略（跨域请求）

3. JSONP优缺点
JSONP优点是简单兼容性好，可用于解决主流浏览器的跨域数据访问的问题。缺点是仅支持get方法具有局限性,不安全可能会遭受XSS攻击。

4. jQuery的jsonp形式
   
   JSONP都是GET和异步请求的，不存在其他的请求方式和同步请求，且jQuery默认就会给JSONP的请求清除缓存。
```js
$.ajax({
url:"请求地址",
dataType:"jsonp",
type:"get",//可以省略
jsonpCallback:"show",//->自定义传递给服务器的函数名，而不是使用jQuery自动生成的，可省略
jsonp:"callback",//->把传递函数名的那个形参callback，可省略
success:function (data){
console.log(data);}
});

```
